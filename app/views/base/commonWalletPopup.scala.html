@import controllers.actions.LoginState
@import views.html.base.buttons._

@(keys: Seq[master.Key])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState)
<div class="walletPopupContainer">
    <div class="d-flex flex-row justify-content-end">
        <i id="openWalletMenu" class="bi bi-list iconDefault iconLarge" onclick="openCloseWalletScreen(this, 'walletMenu')"></i>
    </div>

    <div class="separator"></div>

    <div class="detailContainer">
        <div class="d-flex flex-row align-content-between gap-2 userDetails">
            <img src="@routes.Assets.versioned("images/defaultCollectionProfile.png")" class="rounded-circle" width="40" height="40"/>
            <div class="ml-3 d-flex align-items-center">
                <div class="userName">@loginState.username</div>
            </div>
        </div>
        <div class="row p-2 mx-0 mt-4 justify-content-between align-items-center userAddressBox">
            <div class="col-10 p-0 userAddressData username-data" data-value="@loginState.address">@loginState.address</div>
            <div class="col-2 text-end copyIcon" onclick="copyToClipboard(this)">
                <i id="openWalletMenu" class="bi bi-files iconDefault iconMedium"></i>
            </div>
        </div>
        <div class="innerSeparator"></div>
        <div id="walletBalance_@loginState.address"></div>
        <div class="text-center buttons">
            <a href="https://app.osmosis.zone/?from=USDC&to=MNTL" target="_blank"><button class="primaryButton">@Messages(constants.View.BUY_MORE)</button></a>
            @commonSecondaryFormButton(constants.Form.SEND_COIN, Symbol("parameters") -> s"'${loginState.address}'")
        </div>
        <div class="innerSeparator"></div>
    </div>


        <!-- Wallet Menu -->
    <div id="walletMenu" class="walletMenu">
        <div class="d-flex flow-row justify-content-end">
            <i id="closeWalletMenu" class="bi bi-x iconDefault iconLarge icon" onclick="openCloseWalletScreen(this, 'walletMenu')"></i>
        </div>
        <div class="d-flex flex-column justify-content-between h-100 menuContainer">
            <div class="d-flex flex-column gap-2 align-items-end topMenu">
                <span class="menuItem" onclick="openCloseWalletScreen(this, 'addressBook')">@Messages(constants.View.ADDRESS_BOOK)</span>
            </div>
            <div class="d-flex flex-column align-items-end bottomMenu">
                <span class="mb-2 menuItem">
                    <a onclick="getForm(@utilities.JsRoutes.getJsRouteString(constants.Form.SIGN_OUT.get, ""))">
                    @Messages(constants.View.SIGN_OUT)
                    </a>
                </span>
                <div class="innerSeparator"></div>
                <a href="@routes.ProfileController.viewProfile()">
                    <i class="bi bi-gear iconDefault mt-1 icon"></i>
                </a>
            </div>
        </div>
    </div>

        <!-- Address Book -->
    <div id="addressBook" class="addressBook">
        <div class="d-flex flex-row gap-2 align-items-center mb-3 headerWithBackButton">
            <i id="addressBookCloseBtn" class="bi bi-chevron-left iconDefault mt-1 icon" onclick="openCloseWalletScreen(this, 'addressBook')"></i>
            <div class="headerTitle">@Messages(constants.View.ADDRESS_BOOK_TITLE)</div>
        </div>
         <div class="d-flex flex-column justify-content-between">
            <div class="mt-2 walletAddressList">
            @keys.map { key =>
                <div class="d-flex flex-row-reverse justify-content-between walletAddressItem">
                    @if(key.encryptedPrivateKey.nonEmpty) {
                        @if(key.active) {
                            <input type="radio" name="address" id='@key.address' checked/>
                        } else {
                            <input type="radio" name="address" id='@key.address' onclick="changeActive('@key.address', '@keys.find(_.active).getOrElse("")')"/>
                        }
                    }
                <label for="radio1" class="walletAddressLabel username-data">@key.address</label>
                </div>
            }
            </div>
            <div class="text-center d-flex flex-column align-items-end bottomMenu buttons">
                <div class="d-flex justify-content-center w-100">
                    <button id="newAddressOptionOpenBtn" class="primaryButton" onclick="getForm(jsRoutes.controllers.ProfileController.addNewKey())">@Messages(constants.View.ADD_NEW_ADDRESS_LABEL)</button>
                </div>
                <div class="innerSeparator"></div>
                <a href="@routes.ProfileController.viewProfile()">
                    <i class="bi bi-gear iconDefault mt-1 icon"></i>
                </a>
            </div>
        </div>

    </div>
</div>
<script src="@routes.Assets.versioned("javascripts/profile/settings.js")" type="text/javascript"></script>
<script>fetchBalance('@loginState.address')</script>